names(data)[5] <- "item"
names(data)[6] <- "SI_correct"
data$correct <- data$SI_correct==1
#filtering out NAs, adding agesplit
data %<>%
filter(sub_ID != "", correct != "NA")
data %<>%
rename(Age = agegroup)
#renaming for better-looking graphs
data$type %<>%
str_replace("control_all", "All")%>%
str_replace("control_none", "None")%>%
str_replace("implicature", "Implicature")
data$selection %<>%
str_replace("all", "All")%>%
str_replace("none", "None")%>%
str_replace("some", "Some")
#Find the Mean and median ages
age <- data %>%
dplyr::select(sub_ID, test_age, Age) %>%
dplyr::distinct() %>%
group_by(Age)%>%
summarise(n=n(), avg = mean(test_age))
#use this dataframe for stats
data_SIexp3 <- data %>%
mutate(test = "Scalar Implicature")
#age stats
age <- data_SIexp3 %>%
group_by(Age)%>%
summarise(mean = mean(test_age), median = median(test_age), sd = sd(test_age))
#read in and establish dataframe
d1 <- read.csv("../data/GQ_coding.csv")
d1[,c(8,10,12,14,16,18,20,22, 31, 32, 33, 34)] <- sapply(d1[,c(8,10,12,14,16,18,20,22, 31, 32, 33, 34)],as.character) #for unknown reasons this is necessary for melt.data.frame now
#change to long form
d2=melt.data.frame(d1,c("sub_ID", "test_age","agegroup", "condition", "training"),c("X1_condition", "X2_condition", "X3_condition", "X4_condition", "X5_condition", "X6_condition",  "X7_condition", "X8_condition", "X1_given", "X2_given", "X3_given", "X4_given", "X5_given", "X6_given",  "X7_given", "X8_given", "X1_correct", "X2_correct", "X3_correct", "X4_correct", "X5_correct", "X6_correct",  "X7_correct", "X8_correct"))
#making a respectable df
onethird <- (1/3)*nrow(d2)
data <- d2[1:onethird,]
data$selection <- d2$value[(onethird+1):(onethird*2)]
data$type <- d2$value[(2*onethird+1):nrow(d2)]
names(data)[6] <- "trial"
names(data)[7] <- "prompt"
names(data)[8] <- "num_given"
names(data)[9] <- "GQ_correct"
#filtering data, creating age breaks
data %<>%
filter(sub_ID != "", num_given != "N/A")%>%
rename(Age = agegroup)
#this is because num_given is a factor - need to change to a number - need to do this for standard error
data$num_given <- as.character(data$num_given)
data$num_given <- as.numeric(data$num_given)
data$GQ_correct <-as.character(data$GQ_correct)
data$GQ_correct <- as.numeric(data$GQ_correct)
#renaming things for prettier graphs
data$prompt %<>%
str_replace("all", "All")%>%
str_replace("most", "Most")%>%
str_replace("some", "Some")%>%
str_replace("none", "None")
#creating dataframe for analyses
data_gq <- data %>%
mutate(test = "Give-Quantifier")
#wide-form
d1 <- read.csv("../data/DCCS_coding.csv")
#long form
d2=melt.data.frame(d1,c("sub_ID","test_age", "agegroup", "condition"),c("pre_1", "pre_2", "pre_3", "pre_4", "pre_5", "pre_6",  "post_1", "post_2", "post_3", "post_4", "post_5", "post_6"))
#filtering data, creating age breaks
data <- d2 %>%
filter(sub_ID != "")
data %<>%
rename(Age = agegroup)
#renaming things
names(data)[5] <- "trial_type"
names(data)[6] <- "DCCS_correct"
#df for further analyses
data_dccs <- data
data_dccs$test <- "DCCS"
#rename trials
tmp1 <- unlist(data$trial_type)%>%
str_replace("pre_1", "pre")%>%
str_replace("pre_2", "pre")%>%
str_replace("pre_3", "pre")%>%
str_replace("pre_4", "pre")%>%
str_replace("pre_5", "pre")%>%
str_replace("pre_6", "pre")%>%
str_replace("post_1", "post")%>%
str_replace("post_2", "post")%>%
str_replace("post_3", "post")%>%
str_replace("post_4", "post")%>%
str_replace("post_5", "post")%>%
str_replace("post_6", "post")
tmp <- as.data.frame(tmp1) %>%
dplyr::rename(switch_type = tmp1)
tmp2 <- bind_cols(data, tmp)
data <- tmp2
#renaming for prettier graphs
data$switch_type %<>%
str_replace("post", "Post-switch")%>%
str_replace("pre", "Pre-switch")
data$switch_type <- as.factor(data$switch_type)
dccs <- data
agg.1<- data_exp1 %>%
mutate(correct = as.integer(correct)) %>%
group_by(condition, type, trial_type, Age)%>%
multi_boot_standard("correct", na.rm=T)
?scale_fill_manual
?ggplot
quartz()
ggplot(data = agg.1,
aes(x=type, y=mean, fill=type)) +
geom_bar(stat="identity", position = position_dodge(1)) +
geom_linerange(aes(ymin = ci_lower,
ymax = ci_upper),
size = .8,
show_guide = FALSE,
position=position_dodge(1)) +
ylab("Proportion correct") +
xlab("Trial Type") +
#   theme_bw(base_size = 17) + theme(axis.title.x = element_text(size=18),
#            axis.title.y  = element_text(size=18)) +
# scale_fill_manual(values = c("#4EB3D3", "#0868AC"))
+ facet_grid(~condition, scale="free_x")
# + geom_hline(yintercept = .5, linetype = "dashed")
source('~/.active-rstudio-document', echo=TRUE)
quartz()
ggplot(data = agg.1,
aes(x=type, y=mean, fill=type)) +
geom_bar(stat="identity", position = position_dodge(1)) +
geom_linerange(aes(ymin = ci_lower,
ymax = ci_upper),
size = .8,
show_guide = FALSE,
position=position_dodge(1)) +
ylab("Proportion correct") +
xlab("Trial Type") +
#   theme_bw(base_size = 17) + theme(axis.title.x = element_text(size=18),
#            axis.title.y  = element_text(size=18)) +
# scale_fill_manual(values = c("#4EB3D3", "#0868AC"))
facet_grid(~condition, scale="free_x")
# + geom_hline(yintercept = .5, linetype = "dashed")
ggplot(data = agg.1,
aes(x=type, y=mean, group=type, fill=type, alpha=Age)) +
geom_bar(stat="identity",position="dodge", colour="black") +
scale_alpha_manual(values=c(0.1, 0.5, 1)) +
coord_flip()
ggplot(data = agg.1,
aes(x=type, y=mean, group=type, fill=type, alpha=Age)) +
geom_bar(stat="identity",position="dodge", colour="black") +
scale_alpha_manual(values=c(0.1, 0.5, 1))
ggplot(data = agg.1,
aes(x=type, y=mean, group=type, fill=type, alpha=Age)) +
geom_bar(stat="identity", position=position_dodge(1)) +
scale_alpha_manual(values=c(0.1, 0.5, 1))
ggplot(data = agg.1,
aes(x=type, y=mean, group=type, fill=type, alpha=Age)) +
geom_histogram(stat="identity", position=position_dodge(1)) +
scale_alpha_manual(values=c(0.1, 0.5, 1))
ggplot(data = agg.1,
aes(x=type, y=mean, group=type, fill=type, alpha=Age)) +
geom_bar(stat="identity", position = position_dodge(1)) +
geom_linerange(aes(ymin = ci_lower,
ymax = ci_upper),
size = .8,
show_guide = FALSE,
position=position_dodge(1)) +
scale_alpha_manual(values=c(0.1, 0.5, 1)) + facet_grid(~condition, scale = "free_x")
ggplot(data = agg.1,
aes(x=type, y=mean, fill=type, alpha=Age)) +
geom_bar(stat="identity", position = position_dodge(1)) +
geom_linerange(aes(ymin = ci_lower,
ymax = ci_upper),
size = .8,
show_guide = FALSE,
position=position_dodge(1)) +
scale_alpha_manual(values=c(0.1, 0.5, 1)) + facet_grid(~condition, scale = "free_x")
?scale_alpha_continuous
?geom_bar
ggplot(data = agg.1,
aes(x=type, y=mean, fill=Age)) +
geom_bar(stat="identity", position = position_dodge(1), colour=type) +
geom_linerange(aes(ymin = ci_lower,
ymax = ci_upper),
size = .8,
show_guide = FALSE,
position=position_dodge(1)) + facet_grid(~condition, scale = "free_x")
ggplot(data = agg.1,
aes(x=type, y=mean, fill=Age)) +
geom_bar(stat="identity", position = position_dodge(1), colour=agg.1$type) +
geom_linerange(aes(ymin = ci_lower,
ymax = ci_upper),
size = .8,
show_guide = FALSE,
position=position_dodge(1)) + facet_grid(~condition, scale = "free_x")
quartz()
ggplot(data = agg.1,
aes(x=type, y=mean, fill=type, alpha=Age)) +
geom_bar(stat="identity", position = position_dodge(1)) +
geom_linerange(aes(ymin = ci_lower,
ymax = ci_upper),
size = .8,
show_legend = FALSE,
position=position_dodge(1)) +
theme_bw(base_size = 13) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
scale_alpha_manual(values=c(0.8, 1)) +
langcog::scale_fill_solarized() +
facet_grid(~condition, scale = "free_x")
quartz()
ggplot(data = agg.1,
aes(x=type, y=mean, fill=type, alpha=Age)) +
geom_bar(stat="identity", position = position_dodge(1)) +
geom_linerange(aes(ymin = ci_lower,
ymax = ci_upper),
size = .8,
show_guide = FALSE,
position=position_dodge(1)) +
theme_bw(base_size = 13) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
scale_alpha_manual(values=c(0.8, 1)) +
langcog::scale_fill_solarized() +
facet_grid(~condition, scale = "free_x")
quartz()
ggplot(data = agg.1,
aes(x=type, y=mean, fill=type, alpha=Age)) +
geom_bar(stat="identity", position = position_dodge(1)) +
geom_linerange(aes(ymin = ci_lower,
ymax = ci_upper),
size = .8,
show.legend = FALSE,
position=position_dodge(1)) +
theme_bw(base_size = 13) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
scale_alpha_manual(values=c(0.8, 1)) +
langcog::scale_fill_solarized() +
facet_grid(~condition, scale = "free_x")
quartz()
ggplot(data = agg.1,
aes(x=type, y=mean, fill=Age, alpha=type)) +
geom_bar(stat="identity", position = position_dodge(1)) +
geom_linerange(aes(ymin = ci_lower,
ymax = ci_upper),
size = .8,
show.legend = FALSE,
position=position_dodge(1)) +
theme_bw(base_size = 13) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
scale_alpha_manual(values=c(0.5,0.6,0.7,0.8,0.9,1)) +
langcog::scale_fill_solarized() +
facet_grid(~condition, scale = "free_x")
agg.1<- data_exp1 %>%
mutate(correct = as.integer(correct)) %>%
group_by(condition, type, trial_type, Age)%>%
multi_boot_standard("correct", na.rm=T)
quartz()
ggplot(data = agg.1,
aes(x=type, y=mean, fill=type, alpha=Age)) +
geom_bar(stat="identity", position = position_dodge(1)) +
geom_linerange(aes(ymin = ci_lower,
ymax = ci_upper),
size = .8,
show.legend = FALSE,
position=position_dodge(1)) +
theme_bw(base_size = 2) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
scale_alpha_manual(values=c(0.8, 1)) +
langcog::scale_fill_solarized() +
facet_grid(~condition, scale = "free_x")
#graph
# quartz()
# ggplot(data = agg.1,
#        aes(x=type, y=mean, fill=type)) +
#   geom_bar(stat="identity", position = position_dodge(1)) +
#   geom_linerange(aes(ymin = ci_lower,
#                       ymax = ci_upper),
#                   size = .8,
#                   show_guide = FALSE,
#                  position=position_dodge(1)) +
#   ylab("Proportion correct") +
#   xlab("Trial Type") +
# #   theme_bw(base_size = 17) + theme(axis.title.x = element_text(size=18),
# #            axis.title.y  = element_text(size=18)) +
#   # scale_fill_manual(values = c("#4EB3D3", "#0868AC"))
#   facet_grid(~condition, scale="free_x")
# # + geom_hline(yintercept = .5, linetype = "dashed")
quartz()
ggplot(data = agg.1,
aes(x=type, y=mean, fill=type, alpha=Age)) +
geom_bar(stat="identity", position = position_dodge(1)) +
geom_linerange(aes(ymin = ci_lower,
ymax = ci_upper),
size = .8,
show.legend = FALSE,
position=position_dodge(1)) +
theme_bw(base_size = 10) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
scale_alpha_manual(values=c(0.8, 1)) +
langcog::scale_fill_solarized() +
facet_grid(~condition, scale = "free_x")
quartz()
ggplot(data = agg.1,
aes(x=type, y=mean, fill=type, alpha=Age)) +
geom_bar(stat="identity", position = position_dodge(1)) +
geom_linerange(aes(ymin = ci_lower,
ymax = ci_upper),
size = .8,
show.legend = FALSE,
position=position_dodge(1)) +
theme_bw(base_size = 10) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
scale_alpha_manual(values=c(0.8, 1)) +
ylab("Mean correct") +
xlab("Trial type") +
langcog::scale_fill_solarized() +
facet_grid(~condition, scale = "free_x")
pdf(file="./out.pdf", width=6, height=4)
p <- ggplot(data = agg.1,
aes(x=type, y=mean, fill=type, alpha=Age)) +
geom_bar(stat="identity", position = position_dodge(1)) +
geom_linerange(aes(ymin = ci_lower,
ymax = ci_upper),
size = .8,
show.legend = FALSE,
position=position_dodge(1)) +
theme_bw(base_size = 10) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
scale_alpha_manual(values=c(0.8, 1)) +
ylab("Mean correct") +
xlab("Trial type") +
langcog::scale_fill_solarized() +
facet_grid(~condition, scale = "free_x")
print(p)
aux <- dev.off()
pdf(file="./exp1_performance.pdf", width=6, height=4)
p <- ggplot(data = agg.1,
aes(x=type, y=mean, fill=type, alpha=Age)) +
geom_bar(stat="identity", position = position_dodge(1)) +
geom_linerange(aes(ymin = ci_lower,
ymax = ci_upper),
size = .8,
show.legend = FALSE,
position=position_dodge(1)) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
scale_alpha_manual(values=c(0.8, 1)) +
ylab("Mean correct") +
xlab("Trial type") +
langcog::scale_fill_solarized() +
facet_grid(~condition, scale = "free_x")
print(p)
aux <- dev.off()
?legend
pdf(file="./exp1_performance.pdf", width=6, height=4)
p <- ggplot(data = agg.1,
aes(x=type, y=mean, fill=type, alpha=Age)) +
geom_bar(stat="identity", position = position_dodge(1)) +
geom_linerange(aes(ymin = ci_lower,
ymax = ci_upper),
size = .8,
show.legend = FALSE,
position=position_dodge(1)) +
theme_bw(base_size = 10) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
scale_alpha_manual(values=c(0.8, 1)) +
ylab("Mean correct") +
xlab("Trial type") +
langcog::scale_fill_solarized() +
facet_grid(~condition, scale = "free_x")
print(p)
aux <- dev.off()
pdf(file="./exp1_performance.pdf", width=6, height=4)
p <- ggplot(data = agg.1,
aes(x=type, y=mean, fill=type, alpha=Age)) +
geom_bar(stat="identity", position = position_dodge(1)) +
geom_linerange(aes(ymin = ci_lower,
ymax = ci_upper),
size = .3,
show.legend = FALSE,
position=position_dodge(1)) +
theme_bw(base_size = 10) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
scale_alpha_manual(values=c(0.8, 1)) +
ylab("Mean correct") +
xlab("Trial type") +
langcog::scale_fill_solarized() +
facet_grid(~condition, scale = "free_x")
print(p)
aux <- dev.off()
?legend
ggplot(data = agg.1,
aes(x=type, y=mean, fill=type, alpha=Age)) +
geom_bar(stat="identity", position = position_dodge(1)) +
geom_linerange(aes(ymin = ci_lower,
ymax = ci_upper),
size = .3,
show.legend = FALSE,
position=position_dodge(1)) +
theme_bw(base_size = 10) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
scale_alpha_manual(values=c(0.8, 1)) +
ylab("Mean correct") +
xlab("Trial type") +
langcog::scale_fill_solarized() +
facet_grid(~condition, scale = "free_x") + guides(fill = FALSE)
pdf(file="./exp1_performance.pdf", width=6, height=4)
p <- ggplot(data = agg.1,
aes(x=type, y=mean, fill=type, alpha=Age)) +
geom_bar(stat="identity", position = position_dodge(1)) +
geom_linerange(aes(ymin = ci_lower,
ymax = ci_upper),
size = .3,
show.legend = FALSE,
position=position_dodge(1)) +
theme_bw(base_size = 10) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
scale_alpha_manual(values=c(0.8, 1)) +
ylab("Mean correct") +
xlab("Trial type") +
langcog::scale_fill_solarized() +
facet_grid(~condition, scale = "free_x") + guides(fill = FALSE)
print(p)
aux <- dev.off()
?guides
pdf(file="./exp1_performance.pdf", width=6, height=4)
p <- ggplot(data = agg.1,
aes(x=type, y=mean, fill=type, alpha=Age)) +
geom_bar(stat="identity", position = position_dodge(1)) +
geom_linerange(aes(ymin = ci_lower,
ymax = ci_upper),
size = .3,
show.legend = FALSE,
position=position_dodge(1)) +
theme_bw(base_size = 12) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
scale_alpha_manual(values=c(0.8, 1)) +
ylab("Mean correct") +
xlab("Trial type") +
langcog::scale_fill_solarized() +
facet_grid(~condition, scale = "free_x") + guides(fill = FALSE)
print(p)
aux <- dev.off()
pdf(file="./exp1_performance.pdf", width=6, height=4)
p <- ggplot(data = agg.1,
aes(x=type, y=mean, fill=type, alpha=Age)) +
geom_bar(stat="identity", position = position_dodge(1)) +
geom_linerange(aes(ymin = ci_lower,
ymax = ci_upper),
size = .3,
show.legend = FALSE,
position=position_dodge(1)) +
theme_bw(base_size = 8) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
scale_alpha_manual(values=c(0.8, 1)) +
ylab("Mean correct") +
xlab("Trial type") +
langcog::scale_fill_solarized() +
facet_grid(~condition, scale = "free_x") + guides(fill = FALSE)
print(p)
aux <- dev.off()
pdf(file="./exp1_hist.pdf", width=6, height=4)
p <- ggplot(exp1_hist, aes(x = mean, fill=type)) +
geom_histogram(colour = "black", stat = "bin",breaks = c(0,.2,.4,.6,.8,1), binwidth = .2) +
theme_bw(base_size = 18) +
xlab("Mean performance") +
ylab("Frequency") +
facet_wrap(~type) +
theme(legend.position="none") +
theme(axis.title.x = element_text(size = 16), axis.title.y = element_text(size = 16)) +
scale_color_solarized() +
scale_x_continuous(breaks = c(0,.2,.4,.6,.8,1))
print(p)
aux <- dev.off()
exp1_hist <- data_exp1 %>%
filter(condition == "Scalar" & type != "All" & type != "Unambig. Some", na.rm = TRUE)%>%
group_by(Subj_ID, type)%>%
multi_boot_standard("numcorr", na.rm = TRUE)
pdf(file="./exp1_hist.pdf", width=6, height=4)
q <- ggplot(exp1_hist, aes(x = mean, fill=type)) +
geom_histogram(colour = "black", stat = "bin",breaks = c(0,.2,.4,.6,.8,1), binwidth = .2) +
theme_bw(base_size = 18) +
xlab("Mean performance") +
ylab("Frequency") +
facet_wrap(~type) +
theme(legend.position="none") +
theme(axis.title.x = element_text(size = 16), axis.title.y = element_text(size = 16)) +
scale_color_solarized() +
scale_x_continuous(breaks = c(0,.2,.4,.6,.8,1))
print(q)
aux <- dev.off()
ggplot(exp1_hist, aes(x = mean, fill=type)) +
geom_histogram(colour = "black", stat = "bin",breaks = c(0,.2,.4,.6,.8,1), binwidth = .2) +
theme_bw(base_size = 18) +
xlab("Mean performance") +
ylab("Frequency") +
facet_wrap(~type) +
theme(legend.position="none") +
theme(axis.title.x = element_text(size = 16), axis.title.y = element_text(size = 16)) +
langcog::scale_color_solarized() +
scale_x_continuous(breaks = c(0,.2,.4,.6,.8,1))
