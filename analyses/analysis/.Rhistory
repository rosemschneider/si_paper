#                       ymax = ci_upper),
#                   size = .8,
#                   show_guide = FALSE,
#                  position=position_dodge(1)) +
#   ylab("Proportion correct") +
#   xlab("Trial Type") +
# #   theme_bw(base_size = 17) + theme(axis.title.x = element_text(size=18),
# #            axis.title.y  = element_text(size=18)) +
#   # scale_fill_manual(values = c("#4EB3D3", "#0868AC"))
#   facet_grid(~condition, scale="free_x")
# # + geom_hline(yintercept = .5, linetype = "dashed")
quartz()
ggplot(data = agg.1,
aes(x=type, y=mean, fill=type, alpha=Age)) +
geom_bar(stat="identity", position = position_dodge(1)) +
geom_linerange(aes(ymin = ci_lower,
ymax = ci_upper),
size = .8,
show.legend = FALSE,
position=position_dodge(1)) +
theme_bw(base_size = 10) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
scale_alpha_manual(values=c(0.8, 1)) +
langcog::scale_fill_solarized() +
facet_grid(~condition, scale = "free_x")
quartz()
ggplot(data = agg.1,
aes(x=type, y=mean, fill=type, alpha=Age)) +
geom_bar(stat="identity", position = position_dodge(1)) +
geom_linerange(aes(ymin = ci_lower,
ymax = ci_upper),
size = .8,
show.legend = FALSE,
position=position_dodge(1)) +
theme_bw(base_size = 10) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
scale_alpha_manual(values=c(0.8, 1)) +
ylab("Mean correct") +
xlab("Trial type") +
langcog::scale_fill_solarized() +
facet_grid(~condition, scale = "free_x")
pdf(file="./out.pdf", width=6, height=4)
p <- ggplot(data = agg.1,
aes(x=type, y=mean, fill=type, alpha=Age)) +
geom_bar(stat="identity", position = position_dodge(1)) +
geom_linerange(aes(ymin = ci_lower,
ymax = ci_upper),
size = .8,
show.legend = FALSE,
position=position_dodge(1)) +
theme_bw(base_size = 10) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
scale_alpha_manual(values=c(0.8, 1)) +
ylab("Mean correct") +
xlab("Trial type") +
langcog::scale_fill_solarized() +
facet_grid(~condition, scale = "free_x")
print(p)
aux <- dev.off()
pdf(file="./exp1_performance.pdf", width=6, height=4)
p <- ggplot(data = agg.1,
aes(x=type, y=mean, fill=type, alpha=Age)) +
geom_bar(stat="identity", position = position_dodge(1)) +
geom_linerange(aes(ymin = ci_lower,
ymax = ci_upper),
size = .8,
show.legend = FALSE,
position=position_dodge(1)) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
scale_alpha_manual(values=c(0.8, 1)) +
ylab("Mean correct") +
xlab("Trial type") +
langcog::scale_fill_solarized() +
facet_grid(~condition, scale = "free_x")
print(p)
aux <- dev.off()
?legend
pdf(file="./exp1_performance.pdf", width=6, height=4)
p <- ggplot(data = agg.1,
aes(x=type, y=mean, fill=type, alpha=Age)) +
geom_bar(stat="identity", position = position_dodge(1)) +
geom_linerange(aes(ymin = ci_lower,
ymax = ci_upper),
size = .8,
show.legend = FALSE,
position=position_dodge(1)) +
theme_bw(base_size = 10) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
scale_alpha_manual(values=c(0.8, 1)) +
ylab("Mean correct") +
xlab("Trial type") +
langcog::scale_fill_solarized() +
facet_grid(~condition, scale = "free_x")
print(p)
aux <- dev.off()
pdf(file="./exp1_performance.pdf", width=6, height=4)
p <- ggplot(data = agg.1,
aes(x=type, y=mean, fill=type, alpha=Age)) +
geom_bar(stat="identity", position = position_dodge(1)) +
geom_linerange(aes(ymin = ci_lower,
ymax = ci_upper),
size = .3,
show.legend = FALSE,
position=position_dodge(1)) +
theme_bw(base_size = 10) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
scale_alpha_manual(values=c(0.8, 1)) +
ylab("Mean correct") +
xlab("Trial type") +
langcog::scale_fill_solarized() +
facet_grid(~condition, scale = "free_x")
print(p)
aux <- dev.off()
?legend
ggplot(data = agg.1,
aes(x=type, y=mean, fill=type, alpha=Age)) +
geom_bar(stat="identity", position = position_dodge(1)) +
geom_linerange(aes(ymin = ci_lower,
ymax = ci_upper),
size = .3,
show.legend = FALSE,
position=position_dodge(1)) +
theme_bw(base_size = 10) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
scale_alpha_manual(values=c(0.8, 1)) +
ylab("Mean correct") +
xlab("Trial type") +
langcog::scale_fill_solarized() +
facet_grid(~condition, scale = "free_x") + guides(fill = FALSE)
pdf(file="./exp1_performance.pdf", width=6, height=4)
p <- ggplot(data = agg.1,
aes(x=type, y=mean, fill=type, alpha=Age)) +
geom_bar(stat="identity", position = position_dodge(1)) +
geom_linerange(aes(ymin = ci_lower,
ymax = ci_upper),
size = .3,
show.legend = FALSE,
position=position_dodge(1)) +
theme_bw(base_size = 10) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
scale_alpha_manual(values=c(0.8, 1)) +
ylab("Mean correct") +
xlab("Trial type") +
langcog::scale_fill_solarized() +
facet_grid(~condition, scale = "free_x") + guides(fill = FALSE)
print(p)
aux <- dev.off()
?guides
pdf(file="./exp1_performance.pdf", width=6, height=4)
p <- ggplot(data = agg.1,
aes(x=type, y=mean, fill=type, alpha=Age)) +
geom_bar(stat="identity", position = position_dodge(1)) +
geom_linerange(aes(ymin = ci_lower,
ymax = ci_upper),
size = .3,
show.legend = FALSE,
position=position_dodge(1)) +
theme_bw(base_size = 12) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
scale_alpha_manual(values=c(0.8, 1)) +
ylab("Mean correct") +
xlab("Trial type") +
langcog::scale_fill_solarized() +
facet_grid(~condition, scale = "free_x") + guides(fill = FALSE)
print(p)
aux <- dev.off()
pdf(file="./exp1_performance.pdf", width=6, height=4)
p <- ggplot(data = agg.1,
aes(x=type, y=mean, fill=type, alpha=Age)) +
geom_bar(stat="identity", position = position_dodge(1)) +
geom_linerange(aes(ymin = ci_lower,
ymax = ci_upper),
size = .3,
show.legend = FALSE,
position=position_dodge(1)) +
theme_bw(base_size = 8) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
scale_alpha_manual(values=c(0.8, 1)) +
ylab("Mean correct") +
xlab("Trial type") +
langcog::scale_fill_solarized() +
facet_grid(~condition, scale = "free_x") + guides(fill = FALSE)
print(p)
aux <- dev.off()
pdf(file="./exp1_hist.pdf", width=6, height=4)
p <- ggplot(exp1_hist, aes(x = mean, fill=type)) +
geom_histogram(colour = "black", stat = "bin",breaks = c(0,.2,.4,.6,.8,1), binwidth = .2) +
theme_bw(base_size = 18) +
xlab("Mean performance") +
ylab("Frequency") +
facet_wrap(~type) +
theme(legend.position="none") +
theme(axis.title.x = element_text(size = 16), axis.title.y = element_text(size = 16)) +
scale_color_solarized() +
scale_x_continuous(breaks = c(0,.2,.4,.6,.8,1))
print(p)
aux <- dev.off()
exp1_hist <- data_exp1 %>%
filter(condition == "Scalar" & type != "All" & type != "Unambig. Some", na.rm = TRUE)%>%
group_by(Subj_ID, type)%>%
multi_boot_standard("numcorr", na.rm = TRUE)
pdf(file="./exp1_hist.pdf", width=6, height=4)
q <- ggplot(exp1_hist, aes(x = mean, fill=type)) +
geom_histogram(colour = "black", stat = "bin",breaks = c(0,.2,.4,.6,.8,1), binwidth = .2) +
theme_bw(base_size = 18) +
xlab("Mean performance") +
ylab("Frequency") +
facet_wrap(~type) +
theme(legend.position="none") +
theme(axis.title.x = element_text(size = 16), axis.title.y = element_text(size = 16)) +
scale_color_solarized() +
scale_x_continuous(breaks = c(0,.2,.4,.6,.8,1))
print(q)
aux <- dev.off()
ggplot(exp1_hist, aes(x = mean, fill=type)) +
geom_histogram(colour = "black", stat = "bin",breaks = c(0,.2,.4,.6,.8,1), binwidth = .2) +
theme_bw(base_size = 18) +
xlab("Mean performance") +
ylab("Frequency") +
facet_wrap(~type) +
theme(legend.position="none") +
theme(axis.title.x = element_text(size = 16), axis.title.y = element_text(size = 16)) +
langcog::scale_color_solarized() +
scale_x_continuous(breaks = c(0,.2,.4,.6,.8,1))
setwd("~/Documents/Projects/si_paper/analyses/analysis")
library(knitr)
opts_chunk$set(cache=TRUE, message=FALSE, warning=FALSE)
rm(list=ls())
library(ggplot2)
library(reshape)
library(plyr)
library(dplyr)
library(stringr)
library(tidyr)
library(markdown)
library(directlabels)
library(magrittr)
library(bootstrap)
library(RCurl)
library(langcog)
library(RColorBrewer)
theme_set(theme_bw())
d2 <- read.csv("../data/implicatures_scalarOnly_data.csv")
data_exp2=melt.data.frame(d2,c("Subj_ID","age","agegroup","list"),c("carrots", "hats", "cookies", "trains", "cats", "purses",  "keys", "shirts", "breads", "horses", "bears", "frogs", "plates", "books", "elephants", "lamps", "bananas", "butterflies",
"carrots_selectionType", "hats_selectionType", "cookies_selectionType", "trains_selectionType", "cats_selectionType", "purses_selectionType",  "keys_selectionType", "shirts_selectionType", "breads_selectionType", "horses_selectionType", "bears_selectionType", "frogs_selectionType", "plates_selectionType", "books_selectionType", "elephants_selectionType", "lamps_selectionType", "bananas_selectionType", "butterflies_selectionType",
"carrots_type", "hats_type", "cookies_type", "trains_type", "cats_type", "purses_type",  "keys_type", "shirts_type", "breads_type", "horses_type", "bears_type", "frogs_type", "plates_type", "books_type", "elephants_type", "lamps_type", "bananas_type", "butterflies_type"))
data <- data_exp2[1:918,]
data$selectionType <- data_exp2$value[919:1836]
data$type <- data_exp2$value[1837:2754]
names(data)[5] <- "item"
names(data)[6] <- "correct"
data_exp2 <- data
attach(data_exp2)
data_exp2$trial_type[type == "some"] <- "implicature"
data_exp2$trial_type[type != "some"] <- "control"
detach(data_exp2)
#rename agegroups
data_exp2$agegroup %<>%
str_replace("3.0--3.5", "3-3.5 years")%>%
str_replace("3.5--4.0", "3.5-4 years")%>%
str_replace("4.0--4.5", "4-4.5 years")%>%
str_replace("4.5--5.0", "4.5-5 years")
data_exp2 %<>%
rename(Age = agegroup)
# data_exp2 %<>%
#   filter(Subj_ID != "", correct != "NA") %>%
#   mutate(agesplit = cut(age, breaks=c(3, 3.5, 4, 4.5, 5)),
#          agesplit = factor(agesplit,
#                            labels=c("3-3.5 years", "3.5-4 years", "4-4.5 years", "4.5-5 years"))) %>%
#   filter(agesplit != "NA")
#renaming for graphs
data_exp2$type <- factor(data_exp2$type,
levels = c("all","none",
"some"),
labels = c("All","None",
"Some"))
data_exp2$selectionType <- factor(data_exp2$selectionType,
levels = c("all","none",
"some"),
labels = c("All","None",
"Some"))
# data_exp2$trial_type <- factor(data_exp2$trial_tyçpe,
#                                levels = c ("control", "implicature"),
#                                labels = c("Control", "Implicature"))
# data_exp2 %<>%
#   rename(Age = agesplit)
# age <- data_exp2 %>%
#   group_by(Age)%>%
# data_exp2$trial_type <- factor(data_exp2$trial_type, levels=c("All", "Some", "None"))
agg.2<- data_exp2 %>%
mutate(correct = as.integer(correct)) %>%
group_by(type, trial_type, Age)%>%
multi_boot_standard("correct", na.rm=T)
agg.2$type <- factor(agg.2$type, levels=c("All","Some", "None"))
pdf(file="./exp2_performance.pdf", width=6, height=4)
p <- ggplot(data = agg.2,
aes(x=type, y=mean, fill=type, alpha=Age)) +
geom_bar(stat="identity", position = position_dodge(1)) +
geom_linerange(aes(ymin = ci_lower,
ymax = ci_upper),
size = .3,
show.legend = FALSE,
position=position_dodge(1)) +
theme_bw(base_size = 8) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
scale_alpha_manual(values=c(0.8, 1)) +
ylab("Mean correct") +
xlab("Trial type") +
langcog::scale_fill_solarized() +
facet_grid(~condition, scale = "free_x") + guides(fill = FALSE)
print(p)
aux <- dev.off()
names(agg.2)
pdf(file="./exp2_performance.pdf", width=6, height=4)
p <- ggplot(data = agg.2,
aes(x=trial_type, y=mean, fill=trial_type, alpha=Age)) +
geom_bar(stat="identity", position = position_dodge(1)) +
geom_linerange(aes(ymin = ci_lower,
ymax = ci_upper),
size = .3,
show.legend = FALSE,
position=position_dodge(1)) +
theme_bw(base_size = 8) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
scale_alpha_manual(values=c(0.8, 1)) +
ylab("Mean correct") +
xlab("Trial type") +
langcog::scale_fill_solarized() + guides(fill = FALSE)
print(p)
aux <- dev.off()
pdf(file="./exp2_performance.pdf", width=6, height=4)
p <- ggplot(data = agg.2,
aes(x=trial_type, y=mean, fill=trial_type, alpha=Age)) +
geom_bar(stat="identity", position = position_dodge(1)) +
geom_linerange(aes(ymin = ci_lower,
ymax = ci_upper),
size = .3,
show.legend = FALSE,
position=position_dodge(1)) +
theme_bw(base_size = 8) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
scale_alpha_manual(values=c(.7,0.8,.9,1)) +
ylab("Mean correct") +
xlab("Trial type") +
langcog::scale_fill_solarized() + guides(fill = FALSE)
print(p)
aux <- dev.off()
pdf(file="./exp2_performance.pdf", width=6, height=4)
p <- ggplot(data = agg.2,
aes(x=trial_type, y=mean, fill=trial_type, alpha=Age)) +
geom_bar(stat="identity", position = "dodge") +
geom_linerange(aes(ymin = ci_lower,
ymax = ci_upper),
size = .3,
show.legend = FALSE,
position=position_dodge(1)) +
theme_bw(base_size = 8) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
scale_alpha_manual(values=c(.7,0.8,.9,1)) +
ylab("Mean correct") +
xlab("Trial type") +
langcog::scale_fill_solarized() + guides(fill = FALSE)
print(p)
aux <- dev.off()
ggplot(data = agg.2,
aes(x=trial_type, y=mean, fill=trial_type, alpha=Age)) +
geom_bar(stat="identity", position = "dodge") +
geom_linerange(aes(ymin = ci_lower,
ymax = ci_upper),
size = .3,
show.legend = FALSE,
position=position_dodge(1)) +
theme_bw(base_size = 8) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
scale_alpha_manual(values=c(.7,0.8,.9,1)) +
ylab("Mean correct") +
xlab("Trial type") +
langcog::scale_fill_solarized() + guides(fill = FALSE)
ggplot(data = agg.2,
aes(x=trial_type, y=mean, fill=trial_type, alpha=Age)) +
geom_bar(position = "dodge") +
geom_linerange(aes(ymin = ci_lower,
ymax = ci_upper),
size = .3,
show.legend = FALSE,
position=position_dodge(1)) +
theme_bw(base_size = 8) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
scale_alpha_manual(values=c(.7,0.8,.9,1)) +
ylab("Mean correct") +
xlab("Trial type") +
langcog::scale_fill_solarized() + guides(fill = FALSE)
ggplot(data = agg.2,
aes(x=trial_type, y=mean, fill=trial_type, alpha=Age)) +
geom_bar(position = "dodge", stat ="identity" ) +
geom_linerange(aes(ymin = ci_lower,
ymax = ci_upper),
size = .3,
show.legend = FALSE,
position=position_dodge(1)) +
theme_bw(base_size = 8) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
scale_alpha_manual(values=c(.7,0.8,.9,1)) +
ylab("Mean correct") +
xlab("Trial type") +
langcog::scale_fill_solarized() + guides(fill = FALSE)
agg.1<- data_exp1 %>%
mutate(correct = as.integer(correct)) %>%
group_by(condition, type, trial_type, Age)%>%
multi_boot_standard("correct", na.rm=T)
agg.2<- data_exp2 %>%
mutate(correct = as.integer(correct)) %>%
group_by(type, trial_type, Age)%>%
multi_boot_standard("correct", na.rm=T)
agg.2$type <- factor(agg.2$type, levels=c("All","Some", "None"))
head(agg.2)
ggplot(data = agg.2,
aes(x=type, y=mean, fill=Age, alpha=type)) +
geom_bar(position = "dodge", stat ="identity" ) +
geom_linerange(aes(ymin = ci_lower,
ymax = ci_upper),
size = .3,
show.legend = FALSE,
position=position_dodge(1)) +
theme_bw(base_size = 8) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
scale_alpha_manual(values=c(.7,.85,1)) +
ylab("Mean correct") +
xlab("Trial type") +
langcog::scale_fill_solarized() + guides(fill = FALSE)
ggplot(data = agg.2,
aes(x=type, y=mean, fill=type, alpha=Age)) +
geom_bar(position = "dodge", stat ="identity" ) +
geom_linerange(aes(ymin = ci_lower,
ymax = ci_upper),
size = .3,
show.legend = FALSE,
position=position_dodge(1)) +
theme_bw(base_size = 8) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
scale_alpha_manual(values=c(.7,.8,.9,1)) +
ylab("Mean correct") +
xlab("Trial type") +
langcog::scale_fill_solarized() + guides(fill = FALSE)
ggplot(data = agg.2,
aes(x=type, y=mean, fill=type, alpha=Age)) +
geom_bar(position = "dodge", stat ="identity" ) +
geom_linerange(aes(ymin = ci_lower,
ymax = ci_upper),
size = .3,
show.legend = FALSE,
position=position_dodge(1)) +
theme_bw(base_size = 8) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
scale_alpha_manual(values=c(.5,.625,.75,1)) +
ylab("Mean correct") +
xlab("Trial type") +
langcog::scale_fill_solarized() + guides(fill = FALSE)
pdf(file="./exp2_performance.pdf", width=6, height=4)
p <- ggplot(data = agg.2,
aes(x=type, y=mean, fill=type, alpha=Age)) +
geom_bar(position = "dodge", stat ="identity" ) +
geom_linerange(aes(ymin = ci_lower,
ymax = ci_upper),
size = .3,
show.legend = FALSE,
position=position_dodge(1)) +
theme_bw(base_size = 8) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
scale_alpha_manual(values=c(.5,.625,.75,1)) +
ylab("Mean correct") +
xlab("Trial type") +
langcog::scale_fill_solarized() + guides(fill = FALSE)
print(p)
aux <- dev.off()
?geom_linerange
ggplot(data = agg.2,
aes(x=type, y=mean, fill=type, alpha=Age)) +
geom_bar(position = "dodge", stat ="identity" ) +
geom_linerange(aes(ymin = ci_lower,
ymax = ci_upper),
size = .3,
show.legend = FALSE,
position=position_dodge(width = 0.9)) +
theme_bw(base_size = 8) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
scale_alpha_manual(values=c(.5,.625,.75,1)) +
ylab("Mean correct") +
xlab("Trial type") +
langcog::scale_fill_solarized() + guides(fill = FALSE)
